{% extends "base_interno.html" %}
{% block title %} Cartera {{ cartera.token }} {% endblock%}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-12">
            <div class="card ">
                <div class="card-header" id="headingOne"
                    style="display: flex; justify-content: space-between;align-items: center;">
                    <div class="mb-0">
                        <button class="btn btn-link">
                            CARTERA: {{ cartera.token }} <br> FECHA:
                            {{ cartera.fecha|date("d-m-Y") }}
                        </button>

                    </div>
                    <div class="mb-0">
                        <a href="#" class="btn btn-danger btn-sm text-white" title="Eliminar">
                            <i class="fas fa-trash"></i>
                        </a>
                    </div>
                </div>

                <div class="card-body">
                    <div class="mt-2 table-responsive">
                        <h4 class="text-center mt-2">DATOS DEL ACREEDOR</h4>
                        <table class="table table-hover text-center ">
                            <thead class="table-info">
                                <tr>
                                    <th>Tipo Documento</th>
                                    <th>Documento</th>
                                    <th>Razón Social/Nombre</th>
                                    <th>Opciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        {{ acreedor.tipo_documento }}
                                        {% if acreedor.tipo_documento == 'nit' %}
                                        <span class="badge badge-primary">Juridica</span>
                                        {% else %}
                                        <span class="badge badge-primary">Natural</span>
                                        {% endif %}
                                    </td>
                                    <td>{{ acreedor.documento }}</td>
                                    <td>{{ acreedor.razon_social }}</td>
                                    <td>
                                        <!-- <a href="#" class="btn btn-info btn-sm text-white" title="Ver">
                                            <i class="fas fa-eye"></i>
                                        </a> -->
                                        <a href="#" class="btn btn-success btn-sm text-white" title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-3">
                        <h4 class="text-center">DOCUMENTOS DE RESPALDO DE LA CARTERA</h4>
                        <table class="table table-hover text-center">
                            <thead class="table-info">
                                <tr>
                                    <th>#</th>
                                    <th>Nombre</th>
                                    <th>Descargar</th>
                                    <th>Opciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if docs %}
                                {% for doc in docs%}
                                <tr>
                                    <td>{{ loop.index }}</td>
                                    <td>{{ doc.nombre }}</td>
                                    <td>
                                        <a href="{{ doc.ruta }}" target="_blank" class="btn btn-dark">
                                            <i class="fas fa-download"></i>
                                        </a>
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-danger btn-sm text-white" title="Eliminar">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                                {% else %}
                                <tr>
                                    <td colspan="4">
                                        <h2 class="alert alert-dark text-center">
                                            No Hay Documentos de Respaldo para el Registrado
                                        </h2>
                                    </td>
                                </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-3 table-responsive">
                        <h4 class="text-center mt-2 ">
                            FICHAS DE REGISTRO
                            <button data-toggle="modal" data-target="#exampleModalScrollable" class="btn btn-info"
                                id="btn_modal">
                                Añadir
                                <i class="fas fa-plus"></i>
                            </button>
                        </h4>
<<<<<<< HEAD
                        <!-- <div class="col-12 mt-3">
                            <h3>
                                Deudor {{ loop.index }}
                            </h3>
                        </div>
                         -->
                         {% for data in deudores %}
                                
                        <table class="table table-hover text-center ">
                            <thead class="table-info">
                                <tr>
                                    <th>Código</th>
                                    <th>Tipo Documento</th>
=======
                        {% for data in deudores %}
                        <table class="table table-hover text-center ">
                            <thead class="table-info">
                                <tr>
                                    <th>Codigo</th>
>>>>>>> 6f41cff3fa60a3cc77cf2c7d4d6505d54070aa78
                                    <th>Documento</th>
                                    <th>Nombre y Apellido</th>
                                    <th>Telefono</th>
                                    <th>Gestor Encargado</th>
                                    <th>Opciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>{{ data.deudor.codigo_deudor }}</td>
                                    <td>
                                        {{ data.deudor.tipodocumento|upper }}-{{ data.deudor.documento }}
                                        {% if data.deudor.tipodocumento == 'nit' %}
                                        <span class="badge badge-primary">Juridica</span>
                                        {% else %}
                                        <span class="badge badge-primary">Natural</span>
                                        {% endif %}
                                    </td>
                                    <td>{{ data.deudor.codigo }}</td>
                                    <td>{{ data.deudor.nombre }} {{ data.deudor.apellido }}</td>
                                    <td>{{ data.deudor.telefono }}</td>
                                    <td> {% if data.deudor.gcodigo %}
                                        {{ data.deudor.gcodigo }} {{ data.deudor.gnombre }} {{ data.deudor.gapellido }}
                                        {% else %}
                                        No tiene Asignado
                                        {% endif %}
                                    </td>
                                    <td>
<<<<<<< HEAD
                               
                               <a href="javascript:leermasproyectos({{ data.deudor.id }});" class="btn btn-xs btn-info" title="Leer Mas"><i class="glyphicon glyphicon-search"></i></a>
                                <!-- <a href="#" onclick="modalverdeudor({{ data.deudor.id }})" class="btn btn-info btn-sm text-white"
                                    title="Ver" data-toggle="modal" data-target="#vista">
                                    <i class="fas fa-eye"></i>
                                </a> -->
<!--                                         <a href="#" class="btn btn-info btn-sm text-white" title="Ver">
                                            <i class="fas fa-eye" data-toggle="modal" data-target=".bd-example-modal-lg"></i>
                                        </a> -->
=======
                                        <a href="#" class="btn btn-info btn-sm text-white" title="Ver" data-toggle="modal" data-target="#vista"> 
                                            <i class="fas fa-eye"></i>
                                        </a>
>>>>>>> 6f41cff3fa60a3cc77cf2c7d4d6505d54070aa78
                                        <a href="#" class="btn btn-warning btn-sm text-white" title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        {% else %}
                        <div class="col-12 mt-4">
                            <h3>El Acreedor {{ acreedor.razon_social }} No Tiene Deudores asociados</h3>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% include 'cartera/ficha.html' %}
<<<<<<< HEAD



<!-- VENTANAS DE VISTA Y EDITAR -->

<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog"
     aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
     <form action="" method="POST" id="modalvermas">
            
    </form>
    </div>
  </div>
</div>
=======
{% include 'cartera/modalDetail.html' %}
>>>>>>> 6f41cff3fa60a3cc77cf2c7d4d6505d54070aa78
{% endblock %}

{% block js %}
{% if flash.getMessage('error') %}
<script>
    $('#btn_modal').click()
</script>
{% endif %}
<script>
    // Evento que selecciona la fila y la elimina
    $(document).on("click", '.eliminar', function () {
        debugger;
        var parent = $(this).parent().parent().get(0);
        $(parent).remove();
    });


    // creare mi funcion para ver mis detalles

    function leermasproyectos(idp)
  {
    $('#modalvermasproyec')[0].reset();
    var url = 'consulta.php?tp=12';
      $.ajax({
      type:'POST',
      url:url,
      data:'tp=12&idp='+idp,
      success: function(valores){
          var datos = eval(valores);
         $('#id_proyecto').val(idp);
         $('#proyecto').val(datos[0]);
         $('#contratantep').val(datos[1]);
         $('#sectorp').val(datos[2]);
         $('#nrocontratop').val(datos[3]);
         $('#fechaip').val(datos[4]);
         $('#objetivocp').val(datos[5]);
         $('#lineap').val(datos[6]);
         $('#subp').val(datos[7]);
         $('#fechafp').val(datos[8]);
         $('#desproyecto').val(datos[9]);
         $('#valorproyecto').val(datos[10]);
         
      $('#VERMASPROYECTOS').modal({
            show:true,
            backdrop:'static'
          });
        return false;
      }
    });
    return false;
  }


</script>
{% endblock %}

